# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание данных

![Используемые интерфейсы в приложении](image.png)

### IAppState

Интерфейс представляет собой общую структуру данных, которая содержит информацию о состоянии всех компонентов приложения.

### IFormState

Интерфейс содердержащий поля для отслеживания валидности введенных пользователем данных.

### IProduct

Описывает структуру которая содержится у продукта. Интерфейс будет использоваться для создания продукта получаемого с сервера.

### IOrderForm

Описывает структуру в полей ввода для подтверждения заказа. Интерфейс будет использоваться для заполнения полей ввода при создании заказа.

### IOrder

Описывает структуру содержания заказа и его конечную стоимость. Данный интерфейс будет наследовать поля IOrderForm. Интерфейс будет использоваться для отправки на сервер уже сформированного заказа(все поля интерфейса IOrderForm должны быть заполнены).

### IOrderResult

Данный интерфейс содержит идентификатор созданного заказа. Интерфейс созданный для того чтобы понять в конце клиентского пути оформлен ли заказ или нет.

### Интерфейсы для отображения моделей данных

### IPageView

#### Интерфейс содержит:

- <code>counter</code> - счетчик который неоходим для отображения количества товаров в корзине.
- <code>catalog</code> - каталог товаров.

### ICardView

Интерфейс содержит поля необходимые для отображения подробной информации о товаре.

### IBacketView

#### Интерфейс содержит:

- <code>products</code> - массив добавленных в корзину продуктов.
- <code>total</code> - итоговая цена товаров.

### IModalView

#### Интерфейс содержит:

- <code>content</code> - поле для хранения карточки(интерфейса) товара.
- <code>open</code> - метод открытия модального окна.
- <code>close</code> - метод закрытия модального окна.

## Модели данных

[Архитектура приложения](architecture.drawio)
![Модели данных](image-1.png)

### Класс <code>Component</code>

Базовый класс предназначен для управления компонентом.

- <code>render</code> - предназначен для отрисовки компонента.
- <code>setText</code> - предназначен для установки текста внутри текстовых полей.
- <code>setImage</code> - предназначен для установки изображения.
- <code>setDisabled</code> - устанавливает кнопке атрибут disabled.
- <code>setHidden</code> - скрывает передаваемый элемент.
- <code>setVisible</code> - показывает передаваемый элемент.
- <code>toggleClass</code> - предназначен переключения классов у элемента.

### Класс <code>Model</code>

Абстрактный класс определяющий базовую структуру для моделей в приложении. Необходим для работы с данными в приложении,управлением состоянием.

### Компоненты представления

### Basket

Будет наследовать <code>Component\<IBasketView></code>.\
В конструкторе класса будут параметры <code>container: HTMLElement</code> и <code>events: EventEmitter</code>\
Содержит:

- <code>list</code> - элемент разметки содержащий список добавленных в корзину товаров.
- <code>total</code> - элемент разметки содержащий итоговую стоимость.
- <code>button</code> - элемент разметки содержащий кнопку для оформления заказа.
- <code>setItems</code> - метод принимающий элементы разметки(товары) и формирующий list.
- <code>setTotal</code> - метод принимающий число, и устанавливающий итоговую стоимость в элемент разметки.

### Form

Будет наследовать <code>Component\<IFormState></code>\
В конструкторе класса будут параметры <code>container: HTMLElement</code> и <code>events: EventEmitter</code>\
Содержит:

- <code>submit</code> - элемент разметки(кнопка), дающая возможность перейти на следующий шаг оформления заказа.
- <code>errors</code> - элемент разметки содержащий итоговую стоимость.
- <code>onInputChange</code> - метод который генерирует событие о изменении значения поля.
- <code>render</code> - метод который обновляет состояние компонента на основе переданного состояния.
- <code>setErrors</code> - метод принимающий строку и устанавливает ее в переменную errors.
- <code>setValid</code> - метод принимающий "булевое" значение и включающий кнопку submit.

### Modal

Будет наследовать <code>Component\<IModalView></code>\
В конструкторе класса будут параметры <code>container: HTMLElement</code> и <code>events: EventEmitter</code>\
Содержит:

- <code>closeButton</code> - элемент разметки содержащий кнопку закрытия модального окна.
- <code>content</code> - элемент разметки содержащий контент который будет отображен внутри модального окна.
- <code>setContent</code> - метод устанавливающий континт внутри модального окна.
- <code>render</code> - метод возвращает элемент разметки который нужно отобразить.
- <code>close</code> - метод закрывающий модальное окно.
- <code>open</code> - метод открывающий модальное окно.

### Page

Отвечает за отображение информации на главной странице веб-приложения.\
Будет наследовать <code>Component\<IPageView></code>.\
В конструкторе класса будут параметры <code>container: HTMLElement</code> и <code>events: EventEmitter</code>

Содержит:

- <code>counter</code> - элемент разметки, к которому будет обращаться компонент.
- <code>catalog</code> - элемент разметки, к которому будет обращаться компонент.
- <code>wrapper</code> - элемент разметки, к которому будет обращаться компонент.
- <code>basket</code> - элемент разметки, к которому будет обращаться компонент.
- <code>setCounter</code> - метод устанавливает значение счетчика корзины на странице.
- <code>setCatalog</code> - метод заменяет текущий каталог товаров на странице новым набором элементов.

### Card

Представляет карточку товара.\
Будет наследовать <code>Component\<ICardView></code>.
В конструкторе класса будут параметры <code>blockName: string</code> и <code>container: HTMLElement</code>

Содержит:

- <code>category</code> - элемент разметки, к которому будет обращаться компонент.
- <code>title</code> - элемент разметки, к которому будет обращаться компонент.
- <code>image</code> - элемент разметки, к которому будет обращаться компонент.
- <code>price</code> - элемент разметки, к которому будет обращаться компонент.
- <code>setId</code> - сеттер устанавливающий карточке товара идентификатор.
- <code>getId</code> - геттер получающий значение идентификатора карточки товара.
- <code>setCategory</code> - сеттер устанавливает категорию карточки товара.
- <code>setTitle</code> - сеттер устанавливает заголовок карточки товара.
- <code>setImage</code> - сеттер устанавливает изображение карточки товара.
- <code>setPrice</code> - сеттер устанавливает стоимость карточки товара.

### CatalogItem

Добавляет функциональность для отображения описания товара.\
Будет наследовать <code>Card</code>.\
В конструкторе класса будет параметр <code>container: HTMLElement</code>

Содержит:

- <code>description</code> - элемент разметки, к которому будет обращаться компонент.
- <code>setDescription</code> - сеттер устанавливает описание карточки товара.

### Order

Будет наследовать <code>Form\<IOrderForm></code>.\
В конструкторе класса будут параметры <code>container: HTMLElement</code> и <code>events: EventEmitter</code>

Содержит:

- <code>setPhone</code> - сеттер устанавливает номер телефона.
- <code>setEmail</code> - сеттер устанавливает электронную почту.
- <code>setAddress</code> - сеттер устанавливает адресс.
- <code>setPayment</code> - сеттер устанавливает метод оплаты.

### AppState

Класс модели данных. Представляет состояние приложения. В нем хранятся данные, относящиеся к текущему состоянию приложения, а также методы для манипуляции этими данными.\
Будет наследовать <code>Modal\<IAppState></code>. Конструктора класса не будет.
Содержит:

- <code>catalog</code> - массив элементов IProduct, описывающих товары в каталоге.
- <code>order</code> - объект, содержащий информацию о заказе.
- <code>preview</code> - строка, содержащая идентификатор предварительно просматриваемого товара.
- <code>setCatalog</code> - метод устанавливает новый каталог товаров и генерирует событие о изменении каталога.
- <code>setPreview</code> - метод устанавливает предварительный просмотр для определенного товара.
- <code>setOrderField</code> - метод устанавливает значения полей заказа и проверяет их валидность.
- <code>validateOrder</code> - метод проверяет валидность данных заказа и генерирует событие об изменении ошибок формы.

## Описание событий.

### Интерфейс <code>IEvents</code>

Содержит:

- <code>on(event: EventName, callback: (data: T) => void): void</code>
- <code>emit(event: string, data?: T): void</code>
- <code>trigger(event: string, context?: Partial<T>): (data: T) => void</code>

### Класс <code>EventEmmiter</code>

Является классом-посредником (Presenter) между классами отображения (View) и классом модели данных (Model)
Реализует интерфейс <code>IEvents</code>. В параметры конструктора класса ничего не передается.

Содержит:

- <code>events</code> - переменная к которую будут кэшироваться события.
- <code>on()</code> - функция установки обработчика на событие.
- <code>off()</code> - функция снятия обработчика с события.
- <code>emit()</code> - функция инициирования события с данными.
- <code>onAll</code> - функция прослушивания всех событий.
- <code>offAll</code> - функция сброса всех обработчиков.
- <code>trigger</code> - функция создающая коллбек триггер, генерирующий событие при вызове.

## События необходимые для работы приложения

- <code>items:changed</code> - срабатывает, когда происходят изменения в каталоге товаров, например, когда добавляются новые товары или происходят изменения в существующих.
- <code>card:select</code> - вызывается при выборе конкретного товара, открывая его карточку для просмотра подробной информации.
- <code>card:buyItem</code> - срабатывает при добавлении товара в корзину покупок.
- <code>basket:open</code> - инициирует открытие корзины.
- <code>basket:close</code> - закрывает корзину после завершения просмотра или редактирования.

<hr>

- <code>preview:change</code> - вызывается для открытия модального окна с дополнительной информацией о выбранном товаре.

<hr>

- <code>modal:open</code> - блокирует прокрутку страницы.
- <code>modal:close</code> - разблокирует прокрутку страницы.

<hr>

- <code>formErrors:change</code> - срабатывает при изменении состояния валидации формы, предоставляя обновленную информацию об ошибках ввода.
- <code>order:open</code> - инициирует открытие формы оформления заказа.
- <code>order:change</code> - вызывается при изменении одного из полей в форме заказа.
- <code>order:submit</code> - срабатывает при отправке заполненной формы заказа.
- <code>order:success</code> - сигнализирует об успешном оформлении заказа после получения подтверждения от сервера.
